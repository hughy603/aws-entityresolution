[mypy]
python_version = 3.12
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
explicit_package_bases = true
namespace_packages = true

# Allow partial type annotations
disallow_incomplete_defs = false
ignore_missing_imports = true

# Be more permissive with any types to reduce noise
disallow_any_unimported = false
disallow_any_expr = false
disallow_any_decorated = false
disallow_any_explicit = false
disallow_any_generics = false
disallow_subclassing_any = false

# Handle duplicate module issues
exclude = [
    "src/aws_entity_resolution/config.py",  # Exclude this if there's also a config directory
]

# Skip errors on missing imports
implicit_reexport = true
follow_imports = skip

# Module-specific ignores
[mypy-tests.*]
disallow_untyped_defs = false
check_untyped_defs = false

[mypy-snowflake.connector.*]
ignore_missing_imports = true

[mypy-boto3.*]
ignore_missing_imports = true

# Fix for duplicate lambda module handler.py files
[mypy-terraform.entity-resolution-pipeline.lambda.*.handler]
ignore_errors = true

# Terraform files - ignore all errors to save time
[mypy-terraform.*]
ignore_errors = true

# Script files - ignore all errors to save time
[mypy-scripts.*]
ignore_errors = true

# Entity resolution scripts
[mypy-terraform.entity-resolution-pipeline.scripts.*]
ignore_errors = true

# Additional ignores for generated code
[mypy-*.py.*.py]
ignore_errors = true

# Disable no-any-return for now as it's often used with external libraries
disable_error_code = no-any-return, var-annotated

# Module-specific ignores
[mypy.plugins.pydantic.config_initializer]
ignore_no_model_config = true

[mypy.plugins.pydantic.incompatible]
ignore_incompatible_field_args = true

[mypy.plugins.pydantic.baseconfig]
ignore_baseconfig_issues = true

[mypy.plugins.pydantic.metaclass]
ignore_metaclass_issues = true

# Specific module overrides
[mypy.overrides]

# Ignore variable annotation complaints that don't affect runtime
[mypy-src.aws_entity_resolution.aws_utils]
disable_error_code = var-annotated

[mypy-src.aws_entity_resolution.services]
disable_error_code = var-annotated, no-untyped-def

[mypy-src.aws_entity_resolution.loader.loader]
disable_error_code = var-annotated

[mypy-src.aws_entity_resolution.config.__init__]
disable_error_code = assignment
